/*!
 * Web Experience Toolkit (WET) / Boîte à outils de l'expérience Web (BOEW)
 * wet-boew.github.io/wet-boew/License-en.html / wet-boew.github.io/wet-boew/Licence-fr.html
 * v4.0.0-b2-development - 2014-02-26
 *
 */!function(a,b,c,d){"use strict";var e,f,g,h="wb-date",i="input[type=date]",j=h+"-inited",k="wb-init."+h,l="setfocus.wb",m="wb-picker",n=new Date,o=n.getMonth(),p=n.getFullYear(),q="YYYY-MM-DD",r=!1,s=d.doc,t=function(b){var c=b.target,h=c.id;if(b.currentTarget===c&&-1===c.className.indexOf(j)){if(d.remove(i),c.className+=" "+j,-1!==c.className.indexOf("picker-field"))return;f||(e=d.i18n,f={show:e("date-show")+e("space"),hide:e("date-hide"),selected:e("date-sel"),close:e("overlay-close")+e("space")+e("esc-key")}),c.className+=" picker-field",g||(g=a("<div id='"+m+"' class='picker-overlay' role='dialog' aria-hidden='true'></div>"),a("<button type='button' class='picker-close mfp-close overlay-close' title='"+f.close+"'>×<span class='wb-inv'> "+f.close+"</span></button>").appendTo(g).on("click",function(a){var b=a.which;b&&1!==b||x(g.attr("aria-controls"))}),g.find("a").attr("tabindex","-1"),a("body > main").after(g)),h&&u(h),r=!0}},u=function(b){var c=a("label").filter("[for='"+b+"']").clone().find(".datepicker-format").remove().end().text(),d=f.show+c,e="<button id='"+b+"-picker-toggle' class='picker-toggle' href='javascript:;' title='"+d+"'><span class='glyphicon glyphicon-calendar'></span><span class='wb-inv'>"+d+"</span></button>";a("#"+b).after(e),g.slideUp(0)},v=function(a,b,e,f,g){var h,i,j,k,m,n,o=c.getElementById(a),p=o.getAttribute("min"),q=o.getAttribute("max"),r=d.date.fromDateISO,s=f.length,t=g?g-1:0;for(p=r(p?p:"1800-01-01"),j=p.getDate()-1,q=r(q?q:"2100-01-01"),k=q.getDate(),h=b===p.getFullYear()&&e===p.getMonth(),i=b===q.getFullYear()&&e===q.getMonth(),m=0;m!==s;m+=1)(!h&&!i||h&&m>=j||i&&k>m)&&(n=f[m],n.innerHTML="<a href='javascript:;' tabindex='"+(m===t?"0":"-1")+"'>"+n.getElementsByTagName("div")[0].innerHTML+"</a>");g&&f.eq(g-1).find("a").trigger(l)},w=function(b,d,e,g){var h,i;a(g).removeClass("picker-sel").find(".picker-sel-text").detach(),h=c.getElementById(b).value;try{""!==h&&(i=new Date(h),i.getUTCFullYear()===d&&i.getUTCMonth()===e&&a(g[i.getUTCDate()-1]).addClass("picker-sel").children("a").attr("aria-selected","true").append("<span class='wb-inv picker-sel-text'> ["+f.selected+"]</span>"))}catch(j){}},x=function(b){var e=c.getElementById(b),h=a(e),i=e.getAttribute("min"),j=e.getAttribute("max"),k=d.date.fromDateISO,n=k(e.value);i||(i="1800-01-01"),j||(j="2100-01-01"),s.trigger("create.wb-cal",[m,p,o,!0,i,j,void 0,b,b+"-picker-toggle"]),h.after(g),"false"!==g.attr("aria-hidden")?(y(b),g.slideDown("fast").attr("aria-hidden","false"),a("#"+b+"-picker-toggle").children("a").children("span").text(f.hide),null!==n?s.trigger("setFocus.wb-cal",[m,p,o,k(i),k(j),n.setDate(n.getDate()+1)]):a("#"+m).trigger(l)):(z(b),h.trigger(l))},y=function(b){var c,d,e=a(".picker-field").get(),f=e.length;for(c=0;c!==f;c+=1)d=e[c].id,d!==b&&z(d)},z=function(b){var c=a("#"+b+"-picker-toggle"),d=a("label[for="+b+"]").text();g.slideUp("fast").attr("aria-hidden","true").trigger("hideGoToFrm.wb-cal"),c.children("a").children("span").text(f.show+d)},A=function(a,b,c,e){var f=d.string.pad;return e.replace("DD",f(c,2)).replace("D",c).replace("MM",f(b,2)).replace("M",b).replace("YYYY",a).replace("YY",a.toString().substr(2,2))};s.on("timerpoke.wb "+k,i,t),s.on("click vclick touchstart focusin",function(b){var d,e=b.which;return!r||e&&1!==e||(d=c.getElementById(m),null===d||"false"!==d.getAttribute("aria-hidden")||b.target.id===d.id||a.contains(d,b.target))?void 0:(z(d.getAttribute("aria-controls")),!1)}),s.on("keydown displayed.wb-cal","#"+m,function(b,c,d,e,f){var g=a(this),h=b.type,i=b.which,j=g.attr("aria-controls");switch(h){case"keydown":27===i&&(y(),a("#"+j).trigger(l));break;case"displayed":v(j,c,d,e,f),w(j,c,d,e);break;case"click":case"vclick":case"touchstart":case"focusin":g.attr("aria-hidden")===!1&&(i&&1!==i||(b.stopPropagation?b.stopImmediatePropagation():b.cancelBubble=!0))}}),s.on("click",".picker-toggle",function(a){a.preventDefault();var b,c=a.which;return 1===c?(b=this.id,x(b.substring(0,b.indexOf("-picker-toggle"))),!1):void 0}),s.on("click",".cal-days a",function(b){var e,f,g,h,i,j,k=b.which;return k&&1!==k?void 0:(e=c.getElementById(m).getAttribute("aria-controls"),f=d.date.fromDateISO(this.getElementsByTagName("time")[0].getAttribute("datetime")),g=f.getFullYear(),h=f.getMonth(),i=f.getDate(),j=a("#"+e),j.val(A(g,h+1,i,q)),w(e,g,h,i),x(e),!1)}),d.add(i)}(jQuery,window,document,wb);